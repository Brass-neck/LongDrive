# 1080P60

- 1080p 是一种视频显示格式，指的是 1920x1080 分辨率的画面
- 60 指的是帧率，可以理解为一秒内图像更新的次数，单位是 Hz（赫兹）
- 类似的还有 4K30、7K50 等等
  - 4K 表示 3840x2160 像素；像素越大，即画面分辨率越大，每一帧要处理的数据量就越大，对于相机的处理负荷就越重，导致每秒能处理的的帧数就越少
  - 7K 表示 2716x1524

# 视频的编码格式 H264/H265 编码概念

视频的编码格式 是一种 **压缩方式**，注重解决的问题是：怎么以最小的码率达到最低的失真

### H264

- H264 是一种帧间编码，只记录每一帧之间的变化，后期解码的时候只要在上一帧基础上算出变化就可以了，不仅大幅度缩小体积，还能保持比较好的画质
- 苹果公司当初毅然决然抛弃了 Adobe 的 VP6 编码，选择了 H.264，这个标准也就随着数亿台 iPad 和 iPhone 走入了千家万户，成为了目前视频编码领域的绝对霸主，占有超过 80%的份额。H.264 也被广泛用于网络流媒体数据、各种高清晰度电视广播以及卫星电视广播等领域
- H.264 最大的优势是具有很高的**数据压缩比率**，将大大节省用户的下载时间和数据流量收费
- 同时 H.264 比其他编码标准有着**更高的视频质量 和 更低的码率**

### I 帧、P 帧、B 帧

在 H264 协议里定义了三种帧，完整编码的帧叫 I 帧，参考之前的 I 帧生成的只包含差异部分编码的帧叫 P 帧，还有一种参考前后的帧编码的帧叫 B 帧

H264 采用的核心算法是帧内压缩和帧间压缩，帧内压缩是生成 I 帧的算法，帧间压缩是生成 B 帧和 P 帧的算法

在 H264 中，图像以**序列**为单位进行组织，一个序列是一段图像编码后的数据流，以 I 帧开始，到下一个 I 帧结束；
一个序列就是一段内容**差异不太大**的图像编码后生成的一串数据流。当运动变化比较少时，一个序列可以很长，因为运动变化少就代表图像画面的内容变动很小，所以就可以编一个 I 帧，然后一直 P 帧、B 帧了。当运动变化多时，可能一个序列就比较短了，比如就包含一个 I 帧和 3、4 个 P 帧

一般来说，I 帧的压缩率是 7（跟 JPG 差不多），P 帧是 20，B 帧可以达到 50。可见使用 B 帧能节省大量空间，节省出来的空间可以用来保存多一些 I 帧，这样在相同码率下，可以提供更好的画质

##### I 帧

- I 帧表示关键帧，这一帧画面是完整保留的；解码时只需要本帧数据就可以完成（因为包含完整画面）
- 它是一个全帧压缩编码帧。它将全帧图像信息进行 JPEG 压缩编码及传输；解码时仅用 I 帧的数据就可重构完整图像
- I 帧不需要参考其他画面而生成
- I 帧是 P 帧和 B 帧的参考帧(其质量直接影响到同组中以后各帧的质量)
- I 帧是帧组 GOP 的基础帧(第一帧),在一组中只有一个 I 帧
- I 帧不需要考虑运动矢量
- I 帧所占数据的信息量比较大

##### P 帧

- 是前向预测编码帧。P 帧表示的是这一帧跟之前的一个关键帧（或 P 帧）的差别，解码时需要用之前缓存的画面叠加上本帧定义的差别，生成最终画面
- 也就是差别帧，P 帧没有完整画面数据，只有与前一帧的画面差别的数据；
- 也叫预测帧，P 帧采用运动补偿的方法传送它与前面的 I 或 P 帧的差值及运动矢量(预测误差)
- P 帧是 I 帧后面相隔 1~2 帧的编码帧
- 解码时必须将 I 帧中的预测值与预测误差求和后才能重构完整的 P 帧图像
- P 帧可以是其后面 P 帧的参考帧,也可以是其前后的 B 帧的参考帧
- 由于 P 帧是参考帧,它可能造成解码错误的扩散
- 由于是差值传送,P 帧的压缩比较高

##### B 帧

- 双向预测内插编码帧。B 帧是双向差别帧，也就是 B 帧记录的是本帧与前后帧的差别
- 要解码 B 帧，不仅要取得之前的缓存画面，还要解码之后的画面，通过前后画面的与本帧数据的叠加取得最终的画面
- B 帧压缩率高，但是解码时 CPU 会比较累
- B 帧不是参考帧,不会造成解码错误的扩散

### H265

H265/HEVC 的编码架构大致上和 H.264/AVC 的架构相似，也主要包含：帧内预测(intra prediction)、帧间预测(inter prediction)、转换(transform)、量化(quantization)、去区块滤波器(deblocking filter)、熵编码(entropy coding)等模块。但在 HEVC 编码架构中，整体被分为了三个基本单位，分別是：编码单位(coding unit，CU)、预测单位(predict unit，PU)和转换单位(transform unit，TU)

### 封装格式 & 编码格式

我们平时所说的 MP4、AVI、FLV、MOV 这些，都属于**封装格式**，也就是一个水瓶子，封装格式把视频、音频、媒体信息、字幕等统统灌进去，不同的封装方式对应的编码格式也是不同的，常见对应关系：

- 【MP4】H265、H264、MPEG4...

- 【AVI】MPEG2、AC1、H264、DIVX、XVID...

- 【MOV】MPEG2、H264、XVID...

- 【WMV】WMV、AC1...

- 【WebM】VP8、VP9...

- 【RM/RMVB】RV、RM...

- 【TS/PS】MPEG2、H264、MPEG4...

- 【MKV】所有视频编码格式

不同的编码器虽然有微小的差别，但决定画质的，往往还是码率，码率越大，就意味着保存的信息量越多。

# 视频码率

- 也称比特率 Bit Rate
- 视频的码率是视频单位时间内传递的数据量，一般单位是 kbps 即千位每秒；通俗一点的理解就是取样率，单位时间内取样率越大，精度就越高，处理出来的文件就越接近原始文件
- 码率越高，视频的清晰度越好
- 码率越高，视频体积也就越大
- 一般“码率 × 视频的时间（秒）÷8=视频大小”
  - 比如，码率为 5 的视频，长度 15 秒，大小为 (5 \* 15 / 8 = 9M) 左右
- 码率越高，对播放视频的设备也是有要求的
